{% extends 'template/jhTemplateV4.html'%}

{% block vueTemplate %}
<script type="text/html" id="app-template">
<div>
<v-app mobile-breakpoint="sm">
  <!-- <jh-menu /> -->
  <v-main class="mt-13">
    <v-container>
      <v-textarea v-model="htmlCode" @change="playgroundRenderKey++" rows="4" class="jh-v-input" dense single-line filled></v-textarea>
      <v-textarea v-model="jsCode" rows="4" class="jh-v-input" dense single-line filled></v-textarea>
      <iframe src="/<$ ctx.app.config.appId $>/page/test/JHPlaygroundRender" frameborder="0" style="width: 70%; height: auto;"></iframe>
    </v-container>
  </v-main>
</v-app>

<jh-toast />
<jh-mask />
<jh-confirm-dialog />
</div>
</script>

<div id="app">
</div>
{% endblock %}

{% block vueScript %}
<script type="module">
  new Vue({
    el: '#app',
    template: '#app-template',
    vuetify: new Vuetify(),
    data: () => ({
      htmlCode: `<v-col cols="12" sm="12" md="4">
    <span class="jh-input-label">学生名</span>
    <v-text-field v-model="studentName" class="jh-v-input" dense single-line filled></v-text-field>
</v-col>`,
      jsCode: 'js...',
      playgroundRenderKey: 0,

      validationRules: {
        studentName: [
            v => !!v || '学生名字是必填项',
            v => (v && v.length >= 2) || '学生名字至少需要2个字符',
        ],
      },
      studentName: '张',
    }),
    async created() {
    },
    mounted() {
    },
    methods: {
      async doUiAction(uiActionId, uiActionData) {
        switch (uiActionId) {
          case 'createStudent':
            await this.prepareCreateValidate();
            await this.confirmCreateItemDialog();
            await this.doCreateStudent();
            break;
          default:
            console.error("[doUiAction] uiActionId not find", { uiActionId });
            break;
        }
      },
      async prepareCreateValidate() {
        if (await this.$refs.createForm.validate()) {
          return true;
        }
        throw new Error("请完善表单信息")
      },
      async confirmCreateItemDialog() {
        if (await window.confirmDialog({title: "新增", content: "确定新增吗？"}) === false) {
          throw new Error("[confirmCreateFormDialog] 否");
        }
      },
      async doCreateStudent() {
        window.vtoast.success("保存")
      },
    }
  })
</script>

<style scoped>
  html, body {
    height: 100%;
    margin: 0;
    padding: 0;
    overflow: hidden;
  }
</style>
{% endblock %}